/* Manuscript via CSS v2.0
 *
 * Manuscript formatting for authors who draft in markdown.
 *
 * This stylesheet imports its companion -core.css logic stylesheet. The core
 * styles enable US letter-dimensioned short-prose narratives. This stylesheet
 * layers on functionality to enable A4-dimensioned documents, plus long-form
 * and both narrative and non-narrative formatting.
 *
 * Why does this exist?
 *
 * Because many of us writers draft in markdown and want a means to present our
 * work professionally, even if still a preliminary work. Additionally, it
 * offers a means to webify a finished manuscript.
 *
 * Copyright (c) Todd Warner <t0dd@protonmail.com>
 * This work is licensed under Attribution 4.0 International. To view a copy
 * of this license, visit http://creativecommons.org/licenses/by/4.0/
 *
 * The class "switches":
 * - 'US' or 'A4': US Letter is the default
 * - 'prose' or 'poetry': prose is the default.
 * - 'short' or 'long': a manuscript formatted for short prose is the default.
 * - 'narrative' or 'non-narrative': prose-only - formatted for narrative
 *   prose is the default.
 *
 * To enable any of these formatting adjustments, just add the relevant
 * "switch" to the class attribute of the <div id="manuscript"> element in the
 * markdown document. Enabling 'A4' has one difference: you need to add an
 * @page rule after the CSS import call in the style block of the markdown.
 *
 * What these mean:
 *
 * - US or A4: changes the dimensions of printed/paged output.
 *
 * - prose:
 *     - text is left (for LtR languages) justified, ragged-edged, and white
 *       space is squashed.
 *     - narrative: first-line indented, no spaces between paragraphs
 *     - non-narrative: first line flush, spaces between paragraphs
 *
 * - poetry:
 *     - left justified (for LtR languages).
 *     - each m-poem class + multiple ```plaintext stanzas are one poem.
 *     - ```plaintext blocks are considered "stanzas" of poetry and are
 *       - single- or 1.5-spaced (single-plus?) within each stanza
 *       - and spaced between each stanza
 *       - no white-space control otherwise
 *     - top-margins are reduced in certain scenarios
 *     - structure
 *       - title page (same as prose)
 *       - table of content page: .m-chapter.toc -> .m-scene
 *       - the poems: empty .m-chapter -> .m-poem .m-poem .m-poem ...
 *       - acknowledgements page: .m-chapter -> .m-scene
 *
 * - short:
 *     - prose or poetry:
 *       - contact info in the upper-left-hand corner
 *       - facts are posted in the upper-right-hand corner
 *     - prose structure:
 *       - main title block is 1/3 to 1/2 way down the page
 *       - text starts immediately following the main title block.
 *       - parts and chapters do not page break.
 *         Note, most short stories do not have chapters and I can't think of
 *         a reason to have parts.
 *     - poetry structure:
 *       - one poem per document
 *       - no main title block
 *       - no parts, no chapters
 *       - one scene with its own title block
 *       - the scene is a scene of ```plaintext stanzas
 *
 * - long:
 *     - prose or poetry:
 *       - contact info in the upper-left-hand corner
 *       - facts are posted below the title in the title block
 *     - prose or poetry: main title block is 1/3 to 1/2 way down the page
 *     - prose or poetry: part title block is 1/3 to 1/2 way down its own page
 *     - prose: chapter title block is 1/3 to 1/2 way down a new page
 *     - poetry: chapter title block is at the top of a new page
 *     - prose or poetry: double spaced for any prose elements
 *     - poetry: single or 1.5 (single-plus) spaced within each stanza and a
 *       space between each stanza. No white-space control otherwise.
 *
 * - narrative: see prose description above
 * - non-narrative: see prose description above
 */

@import "./_manuscript-core.css";

@page {
    /* The default is already set for US letter.
     * For A4 you need to add this at-page declaration after your imports in
     * your markdown (or HTML) file's <style> block.
@page { size: A4 portrait; margin: 25.4mm; }
     */
}

#manuscript.US {
    /* the default is already set for .US */
}

#manuscript.A4 {
    --m-page-width:  var(--m-page-widthA4);
    --m-page-height: var(--m-page-heightA4);
    --m-page-margin: var(--m-page-marginA4);

    --m-content-width:  calc(var(--m-page-width) - calc(var(--m-page-margin) * 2));
    --m-content-height: calc(var(--m-page-height) - calc(var(--m-page-margin) * 2));
}

#manuscript.narrative {
    /* the default is already set for .narrative */
}

#manuscript.non-narrative:not(.poetry) {
    --m-font-family: var(--m-font-family-non-narrative);
    --m-font-family-preformatted: var(--m-font-family-non-narrative-preformatted);
    --m-font-family-code: var(--m-font-family-non-narrative-code);
    --m-indent: var(--m-indent-non-narrative);
    --m-paragraph-spacing: var(--m-paragraph-spacing-non-narrative);
}

#manuscript.short {
    /* the default is already set for .short */
}
#manuscript.poetry,
#manuscript.short.poetry {
    --m-offset-title: var(--m-offset-title-short-poetry);
}
#manuscript.short.poetry {
    --m-offset-chapters: var(--m-offset-chapters-short-poetry);
    --m-offset-chapters-render: var(--m-offset-chapters-short-poetry);
}
#manuscript.long.poetry {
    --m-offset-chapters: var(--m-offset-chapters-long-poetry);
    --m-offset-chapters-render: var(--m-offset-chapters-long-poetry);
}
#manuscript.poetry {
    --m-font-family:  var(--m-font-family-poetry);
    --m-font-family-preformatted: var(--m-font-family-narrative-preformatted);
    --m-font-family-code: var(--m-font-family-narrative-code);
    --m-font-family-title-poem:  var(--m-font-family-poetry);
    --m-font-family-byline-poem: var(--m-font-family-poetry);
    /* why no "The End" at the end of a poetry manuscript? I don't know, but
     * that's the way it is. */
    --m-30-: "";
}

#manuscript.long {
    --m-offset-title: var(--m-offset-title-long);
    --m-offset-parts: var(--m-offset-parts-long);
    --m-offset-parts-render: var(--m-offset-parts-render-long);
    --m-offset-chapters: var(--m-offset-chapters-long);
    --m-offset-chapters-render: var(--m-offset-chapters-render-long);
    --m-offset-scene: var(--m-offset-scene-long);

    --m-page-break-simulated: var(--m-page-break-simulated-long);

    --m-position-facts:     var(--m-position-facts-long);
    --m-top-facts:          var(--m-top-facts-long);
    --m-bottom-facts:       var(--m-bottom-facts-long);
    --m-left-facts:         var(--m-left-facts-long);
    --m-right-facts:        var(--m-right-facts-long);
    --m-margin-facts:       var(--m-margin-facts-long);
    --m-text-align-facts:   var(--m-text-align-facts-long);
    --m-line-spacing-facts: var(--m-line-spacing-facts-long);
}
@media print {
#manuscript.long {
    /* long-form print behavior:
     * major component page break & position 1/3rd to 5/12th down the page */
    --m-page-break-simulated: 0;
    --m-page-break: var(--m-page-break-long);
}
} /* /print */

/* ********************************************************************* *
 * special-case stylings
 * ********************************************************************* */
.foothang p {
    /* hanging indent */
    padding-left: var(--m-indent) !important;
    text-indent:  calc(var(--m-indent) * -1) !important;
}
.center-max-content,
.table-of-contents,
.toc {
    width: max-content !important;
    margin-left: auto !important; margin-right: auto !important;
}
.force-break-before {
    break-before: page !important;
}
.force-break-after {
    break-after: page !important;
}
/* ********************************************************************* */
