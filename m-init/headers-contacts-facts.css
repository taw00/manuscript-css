/* CSS for Manuscript Formating v3.0
 *
 * Baseline definitions for #m-contact, .m-header, and .m-facts and the content
 * managed by them. This and m-core-page-positioning do some of the same
 * things.
 *
 * Copyright (c) Todd Warner <t0dd@protonmail.com>
 * This work is licensed under Attribution 4.0 International. To view a copy
 * of this license, visit http://creativecommons.org/licenses/by/4.0/
 */

#manuscript {
    & #m-contact {
        /*box-sizing: border-box; XXXCUTXXX*/
        p {
            text-align: var(--m-text-align);
            text-indent: 0;
        }
        a {
            color: var(--m-text-color);
            text-decoration: unset;
            border: unset;
            &:hover {
                color: var(--m-link-color);
            }
        }

    }

    /*
     * .m-header, the baseline configuration
     */
    & .m-header {
        /* this should be, for a 8.5in page, or about 77% */
        width: calc(calc(var(--m-max-width-header)/var(--m-content-width))*100%);
        max-width: var(--m-max-width-header);

        & > blockquote {             /* the epigraphs, layout */
            /* I would have preferred, width: min(max-content, 100%);, but it does
             * not work for some reason. Instead we use a min on the max-width */
            width: max-content;
            max-width: min(var(--m-max-width-epigraph),100%);
            margin: var(--m-elbow-room) auto;
            line-height: var(--m-line-spacing);

            /* the epigraphs, fonts */
            /*text-align: justify; hyphens: auto;*/
            font-size:   var(--m-font-size-epigraph);
            font-weight: var(--m-font-weight-epigraph);
            font-family: var(--m-font-family-epigraph);
            font-style:  var(--m-font-style-epigraph);
        }

        /* all header content starts as centered and with no spacing */
        & > :is(h1, h2, h3, h4, h5, h6),   /* all header prose */
        & > p {                            /* all paragraphs */
            padding: 0; border: 0;
            text-align: center;
        }
        & p {
            /*
            margin-top: var(--m-elbow-room);
            margin-block-start: var(--m-elbow-room);
            */
        }
        & .m-facts > p {
            text-indent: unset;
            text-align: center;
        }

        /* if a header is followed by a header or a scene or a poem â€¦ space! */
        &:has(+ .m-header, + .m-scene, + .m-poem) {
            margin-bottom: calc(var(--m-room-for-two) * 2);;
            margin-block-end: calc(var(--m-room-for-two) * 2);;
        }

        /* explicityly no top and bottom margins for first and last */
        & > :first-child { margin-top: 0; margin-block-start: 0; }
        & > :last-child { margin-bottom: 0;  margin-block-end: 0; }
    }

    /* top-level title header: #manuscript > .m-header */
    & > .m-header {
        & > h1 {                          /* title of the work */
            font-size:   var(--m-font-size-title);
            font-weight: var(--m-font-weight-title);
            font-family: var(--m-font-family-title);
        }
        & > h2 {                       /* subtitle of the work */
            font-size:   var(--m-font-size-subtitle);
            font-weight: var(--m-font-weight-subtitle);
            font-family: var(--m-font-family-subtitle);
        }
        & > h3 {                         /* author of the work */
            font-size:   var(--m-font-size-byline);
            font-weight: var(--m-font-weight-byline);
            font-family: var(--m-font-family-byline);
        }
        & > .m-facts {
            a {
                color: var(--m-text-color);
                text-decoration: unset;
                border: unset;
                &:hover {
                    color: var(--m-link-color);
                }
            }
            & p {
                text-align: var(--m-text-align-facts);
                text-indent: unset;
            }
        }
    }

    /* section.m-part > .m-header (title header for a Part) */
    & section.m-part {
        & > .m-header {
            & > h1 {              /* title: part */
                font-size:   var(--m-font-size-title-part);
                font-weight: var(--m-font-weight-title-part);
                font-family: var(--m-font-family-title-part);
            }
            & > h2 {              /* subtitle: part */
                font-size:   var(--m-font-size-subtitle-part);
                font-weight: var(--m-font-weight-subtitle-part);
                font-family: var(--m-font-family-subtitle-part);
            }
            & > h3 {              /* subtitle: part */
                font-size:   var(--m-font-size-byline-part);
                font-weight: var(--m-font-weight-byline-part);
                font-family: var(--m-font-family-byline-part);
            }
        }
        & .m-facts {
            margin: var(--m-room-for-two) auto 0;
            & p { text-align: center; }
        }
    }

    /* section.m-chapter > .m-header (title header for a Chapter)
                         > .m-facts for a Chapter */
    & section.m-chapter {
        & > .m-header {
            & > h1 {        /* title: chapter */
                font-size:   var(--m-font-size-title-chapter);
                font-weight: var(--m-font-weight-title-chapter);
                font-family: var(--m-font-family-title-chapter);
            }
            & > h2 {        /* subtitle: chapter */
                font-size:   var(--m-font-size-subtitle-chapter);
                font-weight: var(--m-font-weight-subtitle-chapter);
                font-family: var(--m-font-family-subtitle-chapter);
            }
            & > h3 {        /* author: chapter */
                font-size:   var(--m-font-size-byline-chapter);
                font-weight: var(--m-font-weight-byline-chapter);
                font-family: var(--m-font-family-byline-chapter);
            }
        }
        & .m-facts {
            margin: 0 auto;
            & p { text-align: center; }
        }
    }

    /* section.m-poem > .m-header (title header for a Poem (like a scene)) */
    /* div.x-poem > .m-header (title header for an abitrarily inserted poem) */
    & section:is(.m-poem) > .m-header,
    & div:is(.x-poem) > .m-header {
        & > h1 {         /* title: poem*/
            font-size:   var(--m-font-size-title-poem);
            font-weight: var(--m-font-weight-title-poem);
            font-family: var(--m-font-family-title-poem);
            line-height: var(--m-line-spacing-poetry);
        }
        & > h2 {         /* subtitle: poem */
            font-size:   var(--m-font-size-subtitle-poem);
            font-weight: var(--m-font-weight-subtitle-poem);
            font-family: var(--m-font-family-subtitle-poem);
            line-height: var(--m-line-spacing-poetry);
        }
        & > h3 {         /* author byline: poem */
            font-size:   var(--m-font-size-byline-poem);
            font-weight: var(--m-font-weight-byline-poem);
            font-family: var(--m-font-family-byline-poem);
            line-height: var(--m-line-spacing-poetry);
        }
    }

    /* section.m-scene > .m-header (title header for a Scene) */
    & section:is(.m-scene) > .m-header {
        & > h1 {         /* title: scene or poem*/
            font-size:   var(--m-font-size-title-scene);
            font-weight: var(--m-font-weight-title-scene);
            font-family: var(--m-font-family-title-scene);
        }
        & > h2 {         /* subtitle: scene or poem */
            font-size:   var(--m-font-size-subtitle-scene);
            font-weight: var(--m-font-weight-subtitle-scene);
            font-family: var(--m-font-family-subtitle-scene);
        }
        & > h3 {         /* author byline: scene or poem */
            font-size:   var(--m-font-size-byline-scene);
            font-weight: var(--m-font-weight-byline-scene);
            font-family: var(--m-font-family-byline-scene);
        }
    }

    & section.m-scene {
        & .m-facts {
            margin: 0 auto;
            & p { text-align: center; }
        }
        & .m-header > blockquote {
            margin: 0 auto; /* different than top-level, part, and chapter */
        }
    }


    & section.m-poem,
    & div.x-poem {
        & .m-header {
            margin-left: 0;
            margin-inline-start: 0;
            & > blockquote {
                margin-left: 0;
                margin-inline-start: 0;
                width: max-content;
                max-width: min(max-content,100%);
            }
        }
        & .m-facts {
            margin: 0;
            & p {
                text-align: var(--m-text-align);
            }
        }
        & > :is(h1, h2, h3, h4, h5, h6, blockquote, p) {
            padding: 0; border: 0;
            text-align: var(--m-text-align);
        }
    }

} /* end #manuscript */

